'use strict';var a40_0x3046e9=a40_0x3396;(function(_0x296dcc,_0xf70eee){var _0x5cd5ec=a40_0x3396,_0x260750=_0x296dcc();while(!![]){try{var _0x5e0843=parseInt(_0x5cd5ec(0x1ac))/0x1+parseInt(_0x5cd5ec(0x1bb))/0x2*(-parseInt(_0x5cd5ec(0x1e5))/0x3)+-parseInt(_0x5cd5ec(0x1d2))/0x4+-parseInt(_0x5cd5ec(0x1cf))/0x5+parseInt(_0x5cd5ec(0x1e3))/0x6+parseInt(_0x5cd5ec(0x1e1))/0x7+-parseInt(_0x5cd5ec(0x1c1))/0x8;if(_0x5e0843===_0xf70eee)break;else _0x260750['push'](_0x260750['shift']());}catch(_0xa6fe83){_0x260750['push'](_0x260750['shift']());}}}(a40_0x4b50,0x99fab));function a40_0x3396(_0x9883ce,_0x4ae9a4){var _0x4b5061=a40_0x4b50();return a40_0x3396=function(_0x339643,_0x18380f){_0x339643=_0x339643-0x1a8;var _0x2eace0=_0x4b5061[_0x339643];return _0x2eace0;},a40_0x3396(_0x9883ce,_0x4ae9a4);}var _interopRequireDefault=require('@babel/runtime/helpers/interopRequireDefault');exports[a40_0x3046e9(0x1da)]=!![],exports['default']=void 0x0;var _regenerator=_interopRequireDefault(require('@babel/runtime/regenerator')),_asyncToGenerator2=_interopRequireDefault(require('@babel/runtime/helpers/asyncToGenerator')),_inheritsLoose2=_interopRequireDefault(require('@babel/runtime/helpers/inheritsLoose')),_rollout=require('@onekeyfe/rollout'),_AbstractMethod2=_interopRequireDefault(require('./AbstractMethod')),_constants=require('../../constants'),_uploadFirmware=require('./helpers/uploadFirmware'),_builder=require('../../message/builder'),_paramsValidator=require('./helpers/paramsValidator'),_FirmwareInfo=require('../../data/FirmwareInfo'),FirmwareUpdate=function(_0x1e8b37){var _0xd26c94=a40_0x3046e9;(0x0,_inheritsLoose2[_0xd26c94(0x1ae)])(_0x58e3b5,_0x1e8b37);function _0x58e3b5(_0x4139dd){var _0x2ab5fc=_0xd26c94,_0x1c725f;_0x1c725f=_0x1e8b37[_0x2ab5fc(0x1ad)](this,_0x4139dd)||this,_0x1c725f['useEmptyPassphrase']=!![],_0x1c725f[_0x2ab5fc(0x1d0)]=['management'],_0x1c725f['allowDeviceMode']=[_constants['UI'][_0x2ab5fc(0x1c2)],_constants['UI']['INITIALIZE']],_0x1c725f['requireDeviceMode']=[_constants['UI'][_0x2ab5fc(0x1c2)]],_0x1c725f[_0x2ab5fc(0x1b7)]=![],_0x1c725f[_0x2ab5fc(0x1e7)]=!![];var _0x59b53d=_0x4139dd[_0x2ab5fc(0x1c4)];return(0x0,_paramsValidator[_0x2ab5fc(0x1c0)])(_0x59b53d,[{'name':'version','type':_0x2ab5fc(0x1e4)},{'name':_0x2ab5fc(0x1d3),'type':_0x2ab5fc(0x1e0)},{'name':_0x2ab5fc(0x1c3),'type':_0x2ab5fc(0x1d6)},{'name':'binary','type':_0x2ab5fc(0x1bf)},{'name':_0x2ab5fc(0x1dd),'type':_0x2ab5fc(0x1e0)}]),_0x1c725f[_0x2ab5fc(0x1dc)]={'version':_0x59b53d['version'],'btcOnly':_0x59b53d[_0x2ab5fc(0x1d3)],'baseUrl':_0x59b53d[_0x2ab5fc(0x1c3)]||_0x2ab5fc(0x1b4),'binary':_0x59b53d[_0x2ab5fc(0x1c9)],'intermediary':_0x59b53d[_0x2ab5fc(0x1dd)]},_0x1c725f;}var _0x289aaf=_0x58e3b5[_0xd26c94(0x1d5)];return _0x289aaf[_0xd26c94(0x1b3)]=(function(){var _0x4cbaff=_0xd26c94,_0x5bfd85=(0x0,_asyncToGenerator2[_0x4cbaff(0x1ae)])(_regenerator[_0x4cbaff(0x1ae)][_0x4cbaff(0x1a8)](function _0x38cb51(){var _0xa74116=_0x4cbaff,_0x308785,_0x4c2be;return _regenerator[_0xa74116(0x1ae)][_0xa74116(0x1cb)](function _0x591be4(_0xcefcdb){var _0x26f0d9=_0xa74116;while(0x1){switch(_0xcefcdb[_0x26f0d9(0x1b1)]=_0xcefcdb[_0x26f0d9(0x1d7)]){case 0x0:_0xcefcdb[_0x26f0d9(0x1d7)]=0x2;return this[_0x26f0d9(0x1df)]()[_0x26f0d9(0x1d1)];case 0x2:_0x308785=this['createUiPromise'](_constants['UI'][_0x26f0d9(0x1af)],this[_0x26f0d9(0x1c8)]),this[_0x26f0d9(0x1b5)]((0x0,_builder[_0x26f0d9(0x1b6)])(_constants['UI'][_0x26f0d9(0x1b8)],{'view':_0x26f0d9(0x1d9),'customConfirmButton':{'className':_0x26f0d9(0x1ab),'label':_0x26f0d9(0x1cd)},'label':'Do\x20you\x20want\x20to\x20update\x20firmware?\x20Never\x20do\x20this\x20without\x20your\x20recovery\x20card.'})),_0xcefcdb[_0x26f0d9(0x1d7)]=0x6;return _0x308785['promise'];case 0x6:_0x4c2be=_0xcefcdb[_0x26f0d9(0x1db)];return _0xcefcdb[_0x26f0d9(0x1cc)]('return',_0x4c2be[_0x26f0d9(0x1c4)]);case 0x8:case _0x26f0d9(0x1b2):return _0xcefcdb[_0x26f0d9(0x1a9)]();}}},_0x38cb51,this);}));function _0x59aa21(){return _0x5bfd85['apply'](this,arguments);}return _0x59aa21;}()),_0x289aaf[_0xd26c94(0x1e6)]=(function(){var _0x23cbf7=_0xd26c94,_0x117617=(0x0,_asyncToGenerator2[_0x23cbf7(0x1ae)])(_regenerator[_0x23cbf7(0x1ae)][_0x23cbf7(0x1a8)](function _0x256490(){var _0x8e7f9f=_0x23cbf7,_0x2e04da,_0x166184,_0x527237;return _regenerator[_0x8e7f9f(0x1ae)][_0x8e7f9f(0x1cb)](function _0x1ae42c(_0x59b659){var _0x3a661c=_0x8e7f9f;while(0x1){switch(_0x59b659['prev']=_0x59b659[_0x3a661c(0x1d7)]){case 0x0:_0x2e04da=this[_0x3a661c(0x1c8)],_0x59b659[_0x3a661c(0x1b1)]=0x1;if(!this['params'][_0x3a661c(0x1c9)]){_0x59b659[_0x3a661c(0x1d7)]=0x6;break;}_0x166184=this[_0x3a661c(0x1dc)][_0x3a661c(0x1c9)],_0x59b659['next']=0xa;break;case 0x6:_0x59b659[_0x3a661c(0x1d7)]=0x8;return(0x0,_rollout[_0x3a661c(0x1ca)])({'features':_0x2e04da[_0x3a661c(0x1e2)],'releases':(0x0,_FirmwareInfo[_0x3a661c(0x1ce)])(_0x2e04da[_0x3a661c(0x1e2)][_0x3a661c(0x1b9)],_0x2e04da[_0x3a661c(0x1e2)]),'version':this[_0x3a661c(0x1dc)][_0x3a661c(0x1b0)],'btcOnly':this[_0x3a661c(0x1dc)][_0x3a661c(0x1d3)],'baseUrl':this['params'][_0x3a661c(0x1c3)],'intermediary':this[_0x3a661c(0x1dc)]['intermediary']});case 0x8:_0x527237=_0x59b659[_0x3a661c(0x1db)],_0x166184=_0x527237['binary'];case 0xa:_0x59b659[_0x3a661c(0x1d7)]=0xf;break;case 0xc:_0x59b659[_0x3a661c(0x1b1)]=0xc,_0x59b659['t0']=_0x59b659[_0x3a661c(0x1d8)](0x1);throw _constants[_0x3a661c(0x1d4)][_0x3a661c(0x1c6)](_0x3a661c(0x1be),_0x3a661c(0x1c5));case 0xf:return _0x59b659['abrupt'](_0x3a661c(0x1bc),(0x0,_uploadFirmware[_0x3a661c(0x1c7)])(this[_0x3a661c(0x1c8)]['getCommands']()[_0x3a661c(0x1bd)][_0x3a661c(0x1ba)](this[_0x3a661c(0x1c8)][_0x3a661c(0x1de)]()),this[_0x3a661c(0x1b5)],_0x2e04da,{'payload':_0x166184}));case 0x10:case _0x3a661c(0x1b2):return _0x59b659[_0x3a661c(0x1a9)]();}}},_0x256490,this,[[0x1,0xc]]);}));function _0x52dc51(){var _0x5a721f=_0x23cbf7;return _0x117617[_0x5a721f(0x1aa)](this,arguments);}return _0x52dc51;}()),_0x58e3b5;}(_AbstractMethod2['default']);exports[a40_0x3046e9(0x1ae)]=FirmwareUpdate;function a40_0x4b50(){var _0x39e7bc=['next','catch','device-management','__esModule','sent','params','intermediary','getCommands','getPopupPromise','boolean','3424883blLvlS','features','772458PNmicq','array','52230VGsfRX','run','skipFirmwareCheck','mark','stop','apply','wipe','567437JeaVXs','call','default','RECEIVE_CONFIRMATION','version','prev','end','confirmation','https://onekey-asset.com/onekey','postMessage','UiMessage','useDeviceState','REQUEST_CONFIRMATION','major_version','bind','4ofnPUZ','return','typedCall','Method_FirmwareUpdate_DownloadFailed','buffer','validateParams','744408CqCSTf','BOOTLOADER','baseUrl','payload','Failed\x20to\x20download\x20firmware\x20binary','TypedError','uploadFirmware','device','binary','getBinary','wrap','abrupt','Proceed','getReleases','1001395KuklXz','requiredPermissions','promise','906400hYZDWu','btcOnly','ERRORS','prototype','string'];a40_0x4b50=function(){return _0x39e7bc;};return a40_0x4b50();}